# CHAPTER02. 테스트 방법과 테스트 전략

## 테스트 범위와 목적

상황에 맞는 테스트를 작성하기 어렵기에 테스트 범위와 목적을 이해하는 것이 중요

### 테스트 범위

한가지 기능을 구현할 때도 다음과 같은 모듈들을 사용한다. 

1. 라이브러리가 제공한느 함수
2. 로직을 담당하는 함수 
3. UI 관련 함수
4. 웹 API 클라이언트 
5. API 서버
6. 데이터베이스 서버

---

테스트를 작성할 때는 어디부터 어디까지 커버하는 테스트인지 주의해야 한다.  <br>
테스트 범위(레벨)은 크게 4가지로 분리한다. 

- 정적 분석
    
    타입스크립트나 ESLint가 제공하는 기능을 활용, 각 모듈 내부의 검증뿐만 아니라 인접 모듈을 연계해 사용할 때의 문제점도 검증한다.
    
- 단위 테스트
    
    한가지 모듈에 한정항여 해당 모듈이 제공하는 기능을 검증하는 테스트다. 독립된 환경에서 검증하기 때문에 실제로 애플리케이션을 사용할 때는 거의 발생하지 않는 케이스(코너 케이스) 검증에 적합하다.
    
- 통합 테스트
    
    모듈 조합으로 제공되는 기능을 검증하는 테스트.
    범위가 넓어질 수록 효율적인 테스트가 가능하지만 상대적으로 대략적인 검증만
    
- E2E 테스트
    
    1~4를 통틀어 헤드리스 브라우저와 UI 자동화 도구를 결합하여 검증하는 테스트
    가장 광범위한 통합테스트, 실제 사용과 가장 유사
    

### 테스트 목적

1. 기능 테스트(인터랙션 테스트)
    
    개발된 기능에 문제가 없는지 검증한 테스트. 헤드리스 브라우저와 UI 자동화 도구를 사용하는 것이 좋다. 
    
2. 비기능 테스트(접근성 테스트)
    
    신체적, 정신적 특성에 따른 차이 없이 동등하게 제품을 사용할 수 있는지 검증하는 테스트다. 
    
3. 회귀 테스트
    
    특정 시점을 기준으로 전후 차이를 비교하여 문제가 있는지 검증하는 테스트. 
    프론트엔드는 시각적 회귀 테스트가 중요( 시각적으로 보이는 UI를 개발하기 때문 )
    

## 프론트엔드 테스트 범위

### 정적분석

타입스크립트를 활용, 버그를 조기에 발견할 수 있도록 한다. 
타입 추론은 런타임 작동을 예측해주기 때문에 유용

### 단위 테스트

가장 기초적인 테스트, 테스할 모듈이 특정 입력값을 받아 기대하는 출력값을 반환하는지 테스트

### 통합 테스트

여러 모듈을 연동한 기능을 테스트 (책 예시: 셀렉트 박스)

### E2E 테스트

UI 검증과 외부 스토리지와 같이 연동 중인 하위 시스템을 포함하는 테스트

## 프론트엔드 테스트 목적

### 기능 테스트(인터랙션 테스트)

기능테스트는 인터랙션 테스트가 대부분

### 비기능 테스트(접근성 테스트)

접근성 테스트는 비기능 테스트의 한 종류
(오류 응답을 받았을 때 오류 문구를 렌더링한다)

### 시각적 회귀 테스트

CSS는 UI 컴포넌트에 정의된 스타일과 브라우저에 적용된 모든 스타일의 영향을 받는다. <br>
헤드리스 브라우저에 그려진 내용을 캡쳐하여 캡쳐된 이미지 간 차이를 검증

## 테스트 전략 모델

단위 테스트 → 통합 테스트 → E2E 테스트

오른쪽으로 갈 수록 실제 제품과 유사한 테스트가 가능
하지만 많은 시간 비용 필요하다

### 아이스크립 콘과 피라미드

- 아이스크림 콘 : 상층부 테스트의 비중이 높다. (안티패턴), 운용 비용이 높고 외부 모듈의 의존성 때문에 불안정한 테스트가 비교적 많다.
- 테스트 피라미다: 하층부 테스트의 비중이  높다. 가성비 높은 테스트 가능.
상층부 테스트 실행 시간 길고 하층부 빠름 → 안정성 높음

### 테스팅 트로피

책에서 중점으로 다루는 라이브러리. 통합테스트 비중이 가장 높아야 한다. <br>
프론트엔드에서 단일 UI 컴포넌트는 거의 없기 때문에 통합 테스트 비중이 높을 수록 우수한 테스트 전략이라는 것

## 테스트 전략 계획

테스트 대상 및 목적에 따른 판단 기준을 정립 ➡️ 프로젝트에 최적인 전략 수립 가능

### 테스트가 없어 리팩터링이 불안한 경우

릴리스된 기능을 목록으로 정리 → 변경 전후로 결함이 발생하지 않았는지 검증하는 회귀테스트 작성

### 반응형으로 제작된 프로젝트

브라우저를 사용한 시각적 회귀 테스트

- 스토리북: UI 컴포넌트 단위로 시각적 회귀 테스트가 가능하다. (반응형으로 프로젝트를 제작할 때 효율적)
- reg-suit

### 데이터베이스를 포함한 E2E 테스트가 필요한 경우

목 서버가 아닌 실제 웹 API서버를 사용해서 E2E 테스르를 하고 싶다면 테스트용 스테이징 환경을 사용해야 한다. <br>
스테이징 환경 : 실제로 배포할 환경에 가까운 형태로 만든 테스트용 환경

스테이진 환경을 만들지 않고 테스트 자동화 방법 :  <br>
테스트할 시스템을 컨테이너화해 CI환경에서 실행한 후 연동 중인 여러 시스템과 함께 테스트하는 것s
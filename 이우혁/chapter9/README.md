### 스타일 변경 검증의 어려움

CSS는 여러 프로퍼티가 중첩되며 결정되어 최종적으로 적용된 프로퍼티는 명시도나 적용된 순서뿐만 아니라 전역에 정의된 스타일에도 영향을 받는다.

이처럼 스타일 변화는 다양한 요소에서 영향을 받으므로 코드만으로 예측하는 것이 어렵다.

가장 이상적인 방법은 브라우저별로 모든 페이지를 육안으로 확인하는 것이지만 현실적으로 모든 페이지를 육안으로 확인하는 것은 어렵다.

### 스냅숏 테스트

스냅숏 테스트는 시각적 회귀 테스트의 한 방법이다.

- 스냅숏 테스트만으로 전역에 정의된 스타일 영향은 알기 힘들다.

→ 스냅숏 테스트만으로 모든 시각적 회귀 테스트를 대체할 수 없다.

### 시각적 회귀 테스트의 선택지

가장 신뢰도 높은 방법은 실제 브라우저에 렌더링된 화면을 비교하는 것이다.

테스트할 화면을 브라우저에 렌더링하고 특정 시점에 캡쳐한 이미지들을 픽셀 단위로 비교하는 것이 가장 일반적인 시각적 회귀 테스트이다.

- 시각적 회귀 테스트는 크로미움 같은 브라우저를 헤드리스 모드로 실행한 상태에서 실시한다.
- 일반적으로 헤드리스 브라우저는 E2E 테스트 프레임워크에 포함되어 있으며 대부분의 E2E 테스트 프레임워크는 공식적으로 시각적 회귀 테스트를 지원한다.
  - 프레임워크가 지원하는 시각적 회귀 테스트는 페이지 단위로 캡쳐한 화면을 비교한다.
  - 이와 같은 모든 방식으로 모든 페이지를 캡쳐하면 스타일 변경 전후의 차이점을 발견할 수 있다.

조금 더 세세하게 검출하고 싶다면 시각적 회귀 테스트를 UI 컴포넌트 단위로 실시해야 한다.

### reg-cli로 이미지 비교하기

- `actual` : 기존 이미지를 저장하는 디렉토리
- `expected` : 비교할 이미지를 저장하는 디렉토리
- `diff` : 비교 결과를 검출한 이미지를 저장하는 디렉토리

### 스토리캡 도입

스토리캡은 스토리북에 등록된 스토리를 캡처하는 도구이다.

### 시각적 회귀 테스트를 활용한 리팩토링

- 반응형 디자인에 활용하기
  - PC 디자인을 완성하고 모바일 디자인을 작업할 때 PC 디자인에는 영향이 가지 않았는지 시각적 회귀 테스트를 활용하여 해결할 수 있다.
- 릴리즈 직전의 리팩토링에 활용하기
  - 전역 코드를 하나씩 삭제하면서 시각적 회귀 통해 프로젝트에 미치는 영향을 확인할 수 있다.
- 스토리 커밋 습관화
  - 등록된 스토리의 숫자만큼 세밀한 검증이 가능하기 때문에 습관적으로 스토리를 커밋할 것을 권장한다.
